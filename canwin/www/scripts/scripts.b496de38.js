"use strict";angular.module("canwinApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).when("/:category",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/viewpost/:postId",{templateUrl:"views/viewpost.html",controller:"ViewpostCtrl",controllerAs:"viewpost"}).otherwise({redirectTo:"/all"}),b.hashPrefix("!")}]),angular.module("canwinApp").controller("MainCtrl",["$scope","$routeParams","wp",function(a,b,c){a.page=0,a.busy=!0;var d="10";a.init=function(){var e="all";b.category&&(e=b.category),c.getPosts(d,a.page,e).then(function(b){a.posts=b.data.posts,a.maxpages=b.data.pages,a.busy=!1})},a.init(),a.loadMore=function(){if(!a.busy){var e=b.category;a.page<a.maxpages&&c.getPosts(d,a.page,e).then(function(b){a.maxpages=b.data.pages,angular.forEach(b.data.posts,function(b){a.posts.push(b)}),a.busy=!1})}}}]),angular.module("canwinApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("canwinApp").factory("wp",["$q","$http",function(a,b){var c="http://canwin.eready.co.il",d={};return d.getCategories=function(){return b.get(c+"/api/get_category_index/")},d.getPost=function(a){return b.get(c+"/api/get_post/?post_id="+a)},d.getPosts=function(a,d,e){var f="";return f="all"!==e?c+"/api/get_category_posts/?slug="+e+"&count="+a+"&page="+d.toString():c+"/api/get_posts/?count="+a+"&page="+d.toString(),b.get(f)},d}]),angular.module("canwinApp").controller("NavbarCtrl",["$scope","wp",function(a,b){b.getCategories().then(function(b){a.categories=b.data.categories})}]),angular.module("canwinApp").controller("ViewpostCtrl",["$scope","$routeParams","wp",function(a,b,c){c.getPost(b.postId).then(function(b){a.title=b.data.post.title;var c=angular.element("<div></div>");c.append(b.data.post.content),c.find(".crayon-syntax").each(function(a,b){var d=$(this).find("textarea").val(),e=$(this).attr("id");c.find("#"+e).replaceWith("<div hljs>"+d+"</div>")}),c.find("div").removeClass(),c.find("img").removeClass().addClass("img-responsive center-block").wrap("<div class='article-image' layout='row' layout-align='center'></div>"),a.content=c.html()})}]).directive("bindHtmlCompile",["$compile",function(a){return{restrict:"A",link:function(b,c,d){b.$watch(function(){return b.$eval(d.bindHtmlCompile)},function(e){c.html(e&&e.toString());var f=b;d.bindHtmlScope&&(f=b.$eval(d.bindHtmlScope)),a(c.contents())(f)})}}}]),angular.module("canwinApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/main.html",'<div class="row"> <div class="col-sm-4" ng-repeat="post in posts"> <div class="panel panel-default"> <div class="panel-heading"> <h4 class="panel-title"><a ng-href="#!/viewpost/{{post.id}}" ng-bind-html="post.title"></a></h4> </div> <div class="post_except panel-body" ng-bind-html="post.excerpt"></div> <div class="panel-footer"> <a class="btn btn-default" href="#">+1</a> <a class="btn btn-default" href="#">Share</a> </div> </div> </div> </div> <div class="row"> <div class="col-md-12" style="display: block"> <button class="btn btn-primary center-block" ng-click="loadMore()">Load More</button> </div> </div>'),a.put("views/viewpost.html",'<div class="row"> <div class="col-md-12"> <h1 ng-bind-html="title"></h1> <div class="content" bind-html-compile="content"></div> </div> </div>')}]);